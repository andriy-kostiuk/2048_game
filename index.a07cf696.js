!function(){var t,e,r={},a=/*#__PURE__*/function(){var t;function e(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.initialState=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.board=JSON.parse(JSON.stringify(this.initialState)),this.score=0,this.status=e.Statuses.IDLE}return t=[{key:"start",value:function(){this.status=e.Statuses.PLAYING,this.addNewTile(),this.addNewTile()}},{key:"restart",value:function(){this.score=0,this.status=e.Statuses.IDLE,this.board=JSON.parse(JSON.stringify(this.initialState))}},{key:"moveLeft",value:function(){var t=this;this.move(function(){for(var e=0;e<4;e++){var r=t.board[e].filter(function(t){return 0!==t});r=t.mergeTiles(r),r=t.addTrailingZeros(r),t.board[e]=r}})}},{key:"moveRight",value:function(){var t=this;this.move(function(){for(var e=0;e<4;e++){var r=t.board[e].filter(function(t){return 0!==t});r=t.mergeTiles(r.reverse()),r=t.addTrailingZeros(r).reverse(),t.board[e]=r}})}},{key:"moveUp",value:function(){var t=this;this.move(function(){for(var e=0;e<4;e++)!function(e){for(var r=[],a=0;a<4;a++)r.push(t.board[a][e]);r=r.filter(function(t){return 0!==t}),r=t.mergeTiles(r),r=t.addTrailingZeros(r);for(var n=0;n<4;n++)t.board[n][e]=r[n]}(e)})}},{key:"moveDown",value:function(){var t=this;this.move(function(){for(var e=0;e<4;e++)!function(e){for(var r=[],a=0;a<4;a++)r.push(t.board[a][e]);r=r.filter(function(t){return 0!==t}),r=t.mergeTiles(r.reverse()),r=t.addTrailingZeros(r).reverse();for(var n=0;n<4;n++)t.board[n][e]=r[n]}(e)})}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){return this.status}},{key:"mergeTiles",value:function(t){for(var e=[],r=0;r<t.length;r++)t[r]===t[r+1]?(e.push(2*t[r]),this.score+=2*t[r],r++):e.push(t[r]);return e}},{key:"addNewTile",value:function(){var t=this.board.reduce(function(t,e,r){return e.forEach(function(e,a){0===e&&t.push({row:r,col:a})}),t},[]);if(0!==t.length){var e=Math.floor(Math.random()*t.length),r=t[e],a=r.row,n=r.col,s=.1>Math.random()?4:2;this.board[a][n]=s}}},{key:"addTrailingZeros",value:function(t){for(var e=t.slice();e.length<4;)e.push(0);return e}},{key:"updateStatus",value:function(){for(var t=!1,r=0;r<4;r++)for(var a=0;a<4;a++){var n=this.board[r][a];if(2048===n){this.status=e.Statuses.WIN;return}0===n&&(t=!0),a<3&&n===this.board[r][a+1]&&(t=!0),r<3&&n===this.board[r+1][a]&&(t=!0)}this.status=t?e.Statuses.PLAYING:e.Statuses.LOSE}},{key:"move",value:function(t){if(this.status===e.Statuses.PLAYING){var r=JSON.stringify(this.board);t(),r!==JSON.stringify(this.board)&&(this.addNewTile(),this.updateStatus())}}}],function(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}(e.prototype,t),e}();e={IDLE:"idle",PLAYING:"playing",WIN:"win",LOSE:"lose"},(t="Statuses")in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,r=a;var n={};function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=Array(e);r<e;r++)a[r]=t[r];return a}var o="field-cell",i="hidden",u=(n={updateCells:function(t,e){var r=t.getState();Array.from(e).forEach(function(t,e){for(var a=0;a<4;a++){var n=+r[e][a],s=t.children[a];s.textContent=n||"",s.classList="",s.classList.add(o),n&&s.classList.add("".concat(o,"--").concat(n))}})},updateScore:function(t,e,r){var a=t.getScore(),n=Number(e.textContent),s=Number(r.textContent);if(e.textContent=a,a>n){var o=a-n;e.style.setProperty("--score-diffeerence",'"+'.concat(o,'"')),e.classList.remove("game-score--animate"),e.offsetWidth,e.classList.add("game-score--animate")}a>s&&(r.textContent=a,localStorage.setItem("best",a))},updateStatus:function(t,e){var a=function(t){if(Array.isArray(t))return t}(e)||function(t,e){var r,a,n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var s=[],o=!0,i=!1;try{for(n=n.call(t);!(o=(r=n.next()).done)&&(s.push(r.value),3!==s.length);o=!0);}catch(t){i=!0,a=t}finally{try{o||null==n.return||n.return()}finally{if(i)throw a}}return s}}(e,3)||function(t,e){if(t){if("string"==typeof t)return s(t,3);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(t,3)}}(e,3)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=a[0],o=a[1],u=a[2],c=t.getStatus();switch(Array.from(e).forEach(function(t){t.classList.add(i)}),c){case r.Statuses.IDLE:u.classList.remove(i);break;case r.Statuses.WIN:o.classList.remove(i);break;case r.Statuses.LOSE:n.classList.remove(i)}}}).updateCells,c=n.updateScore,l=n.updateStatus,f=new r,d=document.querySelector(".start"),v=document.querySelectorAll(".field-row"),h=document.querySelector(".game-score"),m=document.querySelector(".game-best"),y=document.querySelector(".message-container").children,S=localStorage.getItem("best");function b(){u(f,v),c(f,h,m),l(f,y)}S&&(m.textContent=S),document.addEventListener("keydown",function(t){if(f.getStatus()===r.Statuses.PLAYING){switch(t.key){case"ArrowUp":f.moveUp();break;case"ArrowDown":f.moveDown();break;case"ArrowLeft":f.moveLeft();break;case"ArrowRight":f.moveRight();break;default:return}b()}}),d.addEventListener("click",function(){d.classList.contains("start")?(f.start(),d.classList.replace("start","restart"),d.textContent="Restart"):d.classList.contains("restart")&&(f.restart(),d.classList.replace("restart","start"),d.textContent="Start"),b()})}();
//# sourceMappingURL=index.a07cf696.js.map
